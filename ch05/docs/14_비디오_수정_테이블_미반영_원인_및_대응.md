# 비디오 수정 시 테이블에 반영이 안 되는 이유와 대응

## 가능한 원인

### 1. 폼이 POST로 전송되지 않음 (가장 흔함)
- **원인**: 저장 버튼 클릭 시 JavaScript가 `preventDefault()`로 제출을 막거나, `form.submit()` 호출이 브라우저마다 동작 차이로 실제 전송이 안 될 수 있음.
- **대응**: 수정 폼에는 **submit 이벤트 리스너를 두지 않고** 브라우저 기본 제출만 사용. 제목은 `<input required>`로 필수 처리.

### 2. Windows에서 SQLite DB 경로 오류
- **원인**: `sqlite:///C:\path\to\wetube.db` 형태에서 `\`가 이스케이프로 해석되어 **다른 파일**을 가리킬 수 있음. 앱은 다른 DB에 쓰고, 사용자는 `instance\wetube.db`만 보고 있을 수 있음.
- **대응**: DB URI를 만들 때 경로의 `\`를 `/`로 바꿔서 사용. 앱 시작 시 `[DB] 사용 중: ...` 로 실제 경로 출력해 확인.

### 3. 세션/ORM 추적 이슈
- **원인**: `Video.query.filter_by(id=...).update({...})` 또는 객체 수정 후 `commit()`이 예상대로 flush되지 않는 환경 이슈.
- **대응**: 객체에 직접 할당(`video.title = title`) 후 `db.session.flush()` 호출, 이어서 `commit()`. 실패 시 `try/except`로 로그 출력.

### 4. DB 파일 잠금
- **원인**: DB 브라우저 등 다른 프로그램이 `wetube.db`를 열어 두면 SQLite가 잠금으로 인해 쓰기가 실패하거나 대기할 수 있음.
- **대응**: 수정 테스트 시 다른 도구에서 DB 파일 닫기. 서버 터미널에 에러가 찍히는지 확인.

### 5. POST 요청이 edit 라우트로 오지 않음
- **원인**: 잘못된 URL, 리다이렉트, 또는 메서드가 GET으로 가는 경우.
- **대응**: 서버 로그에 `studio.edit POST video_id=... title=...` 가 찍히는지 확인. 안 찍히면 브라우저 Network 탭에서 `/studio/edit/<id>` POST 발생 여부 확인.

---

## 적용한 코드 측 대응 요약

| 항목 | 조치 |
|------|------|
| 수정 폼 제출 | JS submit 리스너 제거 → 네이티브 제출만 사용, `required`로 제목 필수 |
| DB URI | Windows 경로 `\` → `/` 변환, 시작 시 사용 중인 DB 경로 출력 |
| 수정 라우트 | 객체 할당 + `flush()` + `commit()`, `commit()` 실패 시 예외 로그 |
| 디버깅 | `studio.edit POST` / `studio.edit committed` 로그로 POST 수신·반영 여부 확인 |
