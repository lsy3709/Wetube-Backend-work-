# 07. 작업 체크리스트

## CH05 현재 작업 요약

### 로그인 미연동 – Studio 접근 개선 (완료)

| 항목                                   | 상태 | 비고                                                  |
| -------------------------------------- | ---- | ----------------------------------------------------- |
| Studio 로그인 없이 접근 가능           | ✅   | `/studio`, `/studio/upload`, `/studio/edit`           |
| 헤더에 Studio 링크 추가 (비로그인 시)  | ✅   | `base.html` – 로그인/회원가입 옆 "Studio" 버튼        |
| Studio 인덱스 페이지 로그인 차단 제거  | ✅   | `studio/index.html` – "로그인이 필요합니다" 블록 제거 |
| Studio 업로드 페이지 로그인 차단 제거  | ✅   | `studio/upload.html`                                  |
| Studio 편집 페이지 로그인 차단 제거    | ✅   | `studio/edit.html`                                    |
| studio-page.js 로그인 체크 제거        | ✅   | 비로그인 시에도 목록/업로드 버튼 동작                 |
| studio-upload-page.js 로그인 체크 제거 | ✅   | 업로드 폼 표시·제출 가능                              |
| studio-edit-page.js 로그인 체크 제거   | ✅   | 편집 폼 표시·동작                                     |

### 업로드·백엔드 (기존 유지)

| 항목                                       | 상태 | 비고                        |
| ------------------------------------------ | ---- | --------------------------- |
| 업로드 시 `config.DEFAULT_USER_ID`(1) 사용 | ✅   | `studio.py`                 |
| 비디오/썸네일 검증·저장                    | ✅   | 확장자·용량 제한            |
| DB Video 저장                              | ✅   | SQLite `instance/wetube.db` |

### 실행·테스트

| 항목                        | 상태 | 비고                          |
| --------------------------- | ---- | ----------------------------- |
| `flask run` (FLASK_APP=app) | ✅   | http://127.0.0.1:5000         |
| `/studio` 로그인 없이 접속  | ✅   | 내 동영상·업로드 링크 노출    |
| `/studio/upload` 업로드     | ✅   | 제목·비디오 필수, 썸네일 선택 |

### 문서·코드 주석 (완료)

| 항목 | 상태 | 비고 |
|------|------|------|
| 09_개념_어원_동작원리_문법_사용법.md | ✅ | 개념·어원·동작 원리·문법·사용법 종합 |
| 10_코드_주석_개념_다이어그램_문법_사용법.md | ✅ | 파일별 주석·Mermaid 다이어그램·문법·사용법 |
| app/__init__.py 기능·주석 | ✅ | 단계별 기능 설명·한글 주석 |
| app/__main__.py 기능·주석 | ✅ | 진입점·run 역할 주석 |
| models/__init__.py, user.py, video.py 주석 | ✅ | 모듈·컬럼 설명 |
| routes/__init__.py 주석 | ✅ | Blueprint 등록 안내 |
| Python 3.13 + SQLAlchemy 호환 | ✅ | requirements.txt SQLAlchemy>=2.0.36, 06 문제 해결 |
| 10 문서 1.3 Mermaid 그래프 수정 | ✅ | 특수문자 제거로 렌더 오류 해결 |

---

## 수정된 파일 목록 (이번 작업)

- `app/templates/base.html` – 헤더 Studio 링크 추가
- `app/templates/studio/index.html` – 로그인 블록 제거
- `app/templates/studio/upload.html` – 로그인 블록 제거
- `app/templates/studio/edit.html` – 로그인 블록 제거
- `app/static/js/studio-page.js` – 로그인 체크 제거
- `app/static/js/studio-upload-page.js` – 로그인 체크 제거
- `app/static/js/studio-edit-page.js` – 로그인 체크 제거
- `app/__init__.py` – 기능·주석 보강
- `app/__main__.py` – 기능·주석 보강
- `app/models/__init__.py`, `user.py`, `video.py` – docstring·주석
- `app/routes/__init__.py` – 주석
- `docs/01_개요.md` – 문서 목차 07~10 추가
- `docs/06_사용_및_테스트.md` – Studio 접근·문제 해결(Python 3.13)
- `docs/09_개념_어원_동작원리_문법_사용법.md` – 신규
- `docs/10_코드_주석_개념_다이어그램_문법_사용법.md` – 신규, 1.3 그래프 수정
- `requirements.txt` – SQLAlchemy>=2.0.36 (Python 3.13 호환)

---

## Video-Tag N:M 관계 및 프론트 연동 (완료)

### Video-Tag 모델·기능

| 항목 | 상태 | 비고 |
|------|------|------|
| Tag 모델 생성 (`app/models/tag.py`) | ✅ | tags 테이블 |
| Video ↔ Tag N:M 관계 (video_tags) | ✅ | `app/models/video.py` |
| save_tags(tag_string) 메서드 | ✅ | 콤마 구분 파싱, get_or_create |
| 13_Video_Tag_N대M_관계_및_save_tags.md | ✅ | 문서화 |

### 단위 테스트

| 항목 | 상태 | 비고 |
|------|------|------|
| test_video_tag.py (12개 테스트) | ✅ | save_tags 파싱·관계·commit |
| test_seed_tags_data.py | ✅ | videos, tags, video_tags 시드 |
| conftest: real_app, in-memory DB | ✅ | 격리된 테스트 |
| scripts/seed_db.py | ✅ | pytest 없이 시드 실행 |

### 경고 수정

| 항목 | 상태 | 비고 |
|------|------|------|
| Query.get() → db.session.get() | ✅ | LegacyAPIWarning 해결 |
| datetime.utcnow() → _utc_now() | ✅ | DeprecationWarning 해결 |

### 템플릿·라우트 연동

| 항목 | 상태 | 비고 |
|------|------|------|
| main/index: popular_tags, tag 필터 (?tag=) | ✅ | 인기 태그 DB 연동 |
| main/tag: 태그별 비디오 목록 | ✅ | Tag.videos 조회 |
| main/watch: 비디오 태그, 추천 동영상 | ✅ | related_videos |
| main/search: videos DB | ✅ | (기존 연동 유지) |
| studio/upload: 태그 입력, 카테고리 선택 | ✅ | save_tags, category 저장 |
| studio/edit: 태그·카테고리 편집 | ✅ | 기존 값 pre-fill |

### UI 개선

| 항목 | 상태 | 비고 |
|------|------|------|
| 필터 바 sticky (스크롤 시 고정) | ✅ | home-filter-bar |
| 카테고리/정렬/태그 선택 유지 | ✅ | 링크에 파라미터 전달 |
| active 버튼 배경색 빨간색 | ✅ | --accent 적용 |
| /tag/<tag_name> 라우트 변수 수정 | ✅ | TypeError 해결 |

### 수정된 파일 목록 (Video-Tag·UI 작업)

- `app/models/tag.py` – 신규
- `app/models/video.py` – video_tags, tags, save_tags
- `app/models/__init__.py` – Tag export
- `app/routes/main.py` – _get_popular_tags, tag 필터, tag_name
- `app/routes/studio.py` – tags, category 폼 처리
- `app/templates/main/index.html` – 필터 바, popular_tags, tag 파라미터
- `app/templates/main/tag.html` – DB 연동
- `app/templates/main/watch.html` – tags, related_videos
- `app/templates/studio/upload.html` – 태그·카테고리 입력
- `app/templates/studio/edit.html` – 태그·카테고리 입력
- `app/static/css/base.css` – home-filter-bar, active 색상, --primary
- `tests/conftest.py` – real_app, in-memory DB
- `tests/test_video_tag.py` – 신규
- `tests/test_seed_tags_data.py` – 신규
- `scripts/seed_db.py` – 신규
- `docs/13_Video_Tag_N대M_관계_및_save_tags.md` – 신규

---

## 참고

- **기본 사용자 ID**: `config.DEFAULT_USER_ID` = 1 (로그인 연동 시 `current_user.id`로 교체 예정)
- **문서**: 사용 방법·에러 케이스는 `06_사용_및_테스트.md` 참고
- **시드 실행**: `pytest tests/test_seed_tags_data.py -v` 또는 `python scripts/seed_db.py`
