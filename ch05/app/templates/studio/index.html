{% extends "base.html" %}

{% block title %}Studio - WeTube{% endblock %}

{% block content %}
  <!-- ë¡œê·¸ì¸ ë¯¸ì—°ë™: StudioëŠ” ë¡œê·¸ì¸ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥ (ì—…ë¡œë“œ ì‹œ config.DEFAULT_USER_ID ì‚¬ìš©) -->
  <div class="studio-page">
    <div class="studio-header">
      <div class="studio-header-top">
        <h1 class="studio-title">ë‚´ ë™ì˜ìƒ</h1>
        <a href="{{ url_for('studio.upload') }}" class="btn btn--primary" id="btn-upload">
          <span>ğŸ“¤</span> ë™ì˜ìƒ ì—…ë¡œë“œ
        </a>
      </div>
    </div>

    <div class="studio-content">
      {% if not videos %}
      <div class="studio-empty" id="studio-empty">
        <div class="studio-empty-icon">ğŸ“¹</div>
        <h2>ë™ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤</h2>
        <p>ì²« ë™ì˜ìƒì„ ì—…ë¡œë“œí•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”.</p>
        <a href="{{ url_for('studio.upload') }}" class="btn btn--primary" id="btn-upload-empty">ë™ì˜ìƒ ì—…ë¡œë“œ</a>
      </div>
      {% else %}
      <div class="studio-dashboard">
        <!-- í†µê³„ -->
        <section class="studio-section">
          <h2 class="studio-section-title">í†µê³„</h2>
          <div class="studio-stats-grid">
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.video_count|default(0) }}</div>
              <div class="studio-stat-label">ì´ ë™ì˜ìƒ</div>
            </div>
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.total_views|default(0) }}</div>
              <div class="studio-stat-label">ì´ ì¡°íšŒìˆ˜</div>
            </div>
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.total_likes|default(0) }}</div>
              <div class="studio-stat-label">ì´ ì¢‹ì•„ìš”</div>
            </div>
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.total_comments|default(0) }}</div>
              <div class="studio-stat-label">ì´ ëŒ“ê¸€</div>
            </div>
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.avg_views|default(0) }}</div>
              <div class="studio-stat-label">í‰ê·  ì¡°íšŒìˆ˜</div>
            </div>
            <div class="studio-stat-item">
              <div class="studio-stat-value">{{ stats.avg_likes|default(0) }}</div>
              <div class="studio-stat-label">í‰ê·  ì¢‹ì•„ìš”</div>
            </div>
          </div>
        </section>

        <!-- ìµœê·¼ í™œë™ -->
        <section class="studio-section">
          <h2 class="studio-section-title">ìµœê·¼ í™œë™</h2>
          <div class="studio-recent-grid">
            <div class="studio-recent-item">
              <h3 class="studio-recent-period">ìµœê·¼ 7ì¼</h3>
              <p>ë™ì˜ìƒ: {{ recent_7d.video_count }}ê°œ</p>
              <p>ì¡°íšŒìˆ˜: {{ recent_7d.views }}íšŒ</p>
              <p>ì¢‹ì•„ìš”: {{ recent_7d.likes }}ê°œ</p>
            </div>
            <div class="studio-recent-item">
              <h3 class="studio-recent-period">ìµœê·¼ 30ì¼</h3>
              <p>ë™ì˜ìƒ: {{ recent_30d.video_count }}ê°œ</p>
              <p>ì¡°íšŒìˆ˜: {{ recent_30d.views }}íšŒ</p>
              <p>ì¢‹ì•„ìš”: {{ recent_30d.likes }}ê°œ</p>
            </div>
          </div>
        </section>

        <!-- ì¸ê¸° ë™ì˜ìƒ TOP 5 -->
        {% if top_videos %}
        <section class="studio-section">
          <h2 class="studio-section-title">ì¸ê¸° ë™ì˜ìƒ TOP 5</h2>
          <ul class="studio-top-list">
            {% for video in top_videos %}
            <li class="studio-top-item">
              <a href="{{ url_for('main.watch', video_id=video.id) }}" class="studio-top-link">
                <div class="studio-top-thumb">
                  {% if video.thumbnail_path %}
                  <img src="{{ url_for('main.media_thumbnail', filename=video.thumbnail_path) }}" alt="">
                  {% else %}
                  <span>ğŸ“¹</span>
                  {% endif %}
                </div>
                <div class="studio-top-info">
                  <div class="studio-top-title">{{ video.title }}</div>
                  <div class="studio-top-meta">ì¡°íšŒìˆ˜ {{ video.views }}íšŒ Â· ì¢‹ì•„ìš” {{ video.likes }}ê°œ</div>
                </div>
              </a>
            </li>
            {% endfor %}
          </ul>
        </section>
        {% endif %}

        <!-- ë‚´ ë™ì˜ìƒ ëª©ë¡ -->
        <section class="studio-section">
          <h2 class="studio-section-title">ë‚´ ë™ì˜ìƒ ëª©ë¡</h2>
          <ul class="studio-video-list" id="studio-video-list">
            {% for video in videos %}
            <li class="studio-video-item">
              <div class="studio-video-thumb">
                {% if video.thumbnail_path %}
                <img src="{{ url_for('main.media_thumbnail', filename=video.thumbnail_path) }}" alt="">
                {% else %}
                <span>ğŸ“¹</span>
                {% endif %}
              </div>
              <div class="studio-video-info">
                <a href="{{ url_for('main.watch', video_id=video.id) }}" class="studio-video-title">{{ video.title }}</a>
                <div class="studio-video-meta">ì¡°íšŒìˆ˜ {{ video.views }}íšŒ Â· {{ video.created_at.strftime('%Y.%m.%d') if video.created_at else '-' }}</div>
              </div>
              <div class="studio-video-actions">
                <a href="{{ url_for('main.watch', video_id=video.id) }}" class="btn btn--outline btn--small">ë³´ê¸°</a>
                <a href="{{ url_for('studio.edit', video_id=video.id) }}" class="btn btn--outline btn--small">ìˆ˜ì •</a>
                <form method="post" action="{{ url_for('studio.delete', video_id=video.id) }}" class="studio-delete-inline" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                  <button type="submit" class="btn btn--danger btn--small">ì‚­ì œ</button>
                </form>
              </div>
            </li>
            {% endfor %}
          </ul>
        </section>
      </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/studio-page.js') }}"></script>
{% endblock %}
