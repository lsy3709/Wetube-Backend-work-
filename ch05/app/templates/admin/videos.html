{% extends "base.html" %}

{% block title %}ë™ì˜ìƒ ê´€ë¦¬ - ê´€ë¦¬ì - WeTube{% endblock %}

{% block content %}
  <div class="admin-page admin-videos-page">
    <div class="admin-header">
      <div class="admin-header-left">
        <a href="{{ url_for('admin.index') }}" class="admin-back-link">â† ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</a>
        <h1 class="admin-title">ë™ì˜ìƒ ê´€ë¦¬</h1>
      </div>
      <div class="admin-header-actions">
        <a href="{{ url_for('auth.logout') }}" class="btn btn--outline">ë¡œê·¸ì•„ì›ƒ</a>
      </div>
    </div>

    <div class="admin-content">
      <!-- ê²€ìƒ‰ / í•„í„° -->
      <div class="admin-toolbar">
        <form method="get" action="{{ url_for('admin.videos') }}" class="admin-search">
          <input type="search" name="q" id="video-search" class="admin-search-input" placeholder="ì œëª©, ì—…ë¡œë” ê²€ìƒ‰" value="{{ request.args.get('q', '') }}">
          <button type="submit" class="btn btn--primary" id="btn-search">ê²€ìƒ‰</button>
        </form>
        <div class="admin-filters">
          <select id="video-visibility-filter" class="admin-select">
            <option value="all">ì „ì²´ ê³µê°œì„¤ì •</option>
            <option value="public">ê³µê°œ</option>
            <option value="unlisted">ì¼ë¶€ ê³µê°œ</option>
            <option value="private">ë¹„ê³µê°œ</option>
          </select>
          <select id="video-status-filter" class="admin-select">
            <option value="all">ì „ì²´ ìƒíƒœ</option>
            <option value="normal">ì •ìƒ</option>
            <option value="reported">ì‹ ê³ ë¨</option>
          </select>
        </div>
      </div>

      <!-- ë™ì˜ìƒ ëª©ë¡ í…Œì´ë¸” (DB ì‹¤ë°ì´í„°) -->
      <div class="admin-table-wrap">
        <table class="admin-table admin-table--videos">
          <thead>
            <tr>
              <th class="col-num">#</th>
              <th class="col-thumb">ì¸ë„¤ì¼</th>
              <th class="col-title">ì œëª©</th>
              <th class="col-uploader">ì—…ë¡œë”</th>
              <th class="col-views">ì¡°íšŒìˆ˜</th>
              <th class="col-date">ì—…ë¡œë“œì¼</th>
              <th class="col-visibility">ê³µê°œì„¤ì •</th>
              <th class="col-status">ìƒíƒœ</th>
              <th class="col-actions">ê´€ë¦¬</th>
            </tr>
          </thead>
          <tbody>
            {% for video in videos.items %}
            <tr>
              <td class="col-num">{{ (videos.page - 1) * videos.per_page + loop.index }}</td>
              <td class="col-thumb">
                {% if video.thumbnail_path %}
                <a href="{{ url_for('main.watch', video_id=video.id) }}" class="video-thumb-link">
                  <img src="{{ url_for('main.media_thumbnail', filename=video.thumbnail_path) }}" alt="" class="video-thumb-small-img">
                </a>
                {% else %}
                <div class="video-thumb-small">ğŸ“¹</div>
                {% endif %}
              </td>
              <td class="col-title">
                <a href="{{ url_for('main.watch', video_id=video.id) }}" class="video-title-link">{{ video.title }}</a>
              </td>
              <td class="col-uploader">{{ video.user.username if video.user else '-' }}</td>
              <td class="col-views">{{ video.views }}íšŒ</td>
              <td class="col-date">{{ video.created_at.strftime('%Y-%m-%d') if video.created_at else '-' }}</td>
              <td class="col-visibility">
                <span class="status-badge status-public">ê³µê°œ</span>
              </td>
              <td class="col-status">
                <span class="status-badge status-active">ì •ìƒ</span>
              </td>
              <td class="col-actions">
                <a href="{{ url_for('studio.edit', video_id=video.id) }}" class="btn-icon" title="ìˆ˜ì •">âœï¸</a>
                <form method="post" action="{{ url_for('studio.delete', video_id=video.id) }}" style="display: inline;" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                  <button type="submit" class="btn-icon btn-icon--danger" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                </form>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="9" class="admin-empty">ë“±ë¡ëœ ë™ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
      {% if videos.pages > 1 %}
      <div class="admin-pagination">
        {% if videos.has_prev %}
        <a href="{{ url_for('admin.videos', page=videos.prev_num, q=request.args.get('q', '')) }}" class="btn btn--outline btn--small">ì´ì „</a>
        {% else %}
        <span class="btn btn--outline btn--small" disabled>ì´ì „</span>
        {% endif %}
        <span class="pagination-info">{{ videos.page }} / {{ videos.pages }} í˜ì´ì§€</span>
        {% if videos.has_next %}
        <a href="{{ url_for('admin.videos', page=videos.next_num, q=request.args.get('q', '')) }}" class="btn btn--outline btn--small">ë‹¤ìŒ</a>
        {% else %}
        <span class="btn btn--outline btn--small" disabled>ë‹¤ìŒ</span>
        {% endif %}
      </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/admin-videos-page.js') }}"></script>
{% endblock %}
