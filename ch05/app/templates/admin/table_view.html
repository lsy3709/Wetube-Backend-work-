{% extends "base.html" %}

{% block title %}{{ table_name }} - 데이터베이스 관리 - WeTube{% endblock %}

{% block content %}
  <div class="admin-page admin-table-view-page" data-admin-logged-in-only>
    <div class="admin-header">
      <div class="admin-header-left">
        <a href="{{ url_for('admin.database') }}" class="admin-back-link">← 데이터베이스 관리</a>
        <h1 class="admin-title">테이블: {{ table_name }}</h1>
      </div>
      <div class="admin-header-actions">
        <button type="button" class="btn btn--outline" id="admin-logout-btn">로그아웃</button>
      </div>
    </div>

    <div class="admin-content">
      <!-- 테이블 구조 -->
      <div class="db-section">
        <h3 class="db-section-title">테이블 구조</h3>
        <div class="admin-table-wrap">
          <table class="admin-table db-preview-table">
            <thead>
              <tr>
                <th>컬럼명</th>
                <th>타입</th>
                <th>키</th>
                <th>Null</th>
              </tr>
            </thead>
            <tbody>
              {% for col in columns %}
              <tr>
                <td>{{ col.name }}</td>
                <td>{{ col.type }}</td>
                <td>{{ col.key }}</td>
                <td>{{ col.null }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- 테이블 데이터 -->
      <div class="db-section">
        <h3 class="db-section-title">데이터 (샘플)</h3>
        <div class="admin-table-wrap">
          <table class="admin-table">
            <thead>
              <tr>
                {% for col in columns %}
                <th>{{ col.name }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for row in sample_data %}
              <tr>
                {% for col in columns %}
                <td>{{ row[col.name] }}</td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% if table_name == 'comment' and sample_data %}
        <p class="admin-msg-text">comments 테이블 실제 데이터 (최근 20건)입니다.</p>
        {% elif not sample_data %}
        <p class="admin-msg-text">데이터가 없습니다.</p>
        {% else %}
        <p class="admin-msg-text">테이블 샘플 데이터입니다.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="admin-logged-out" data-admin-logged-out-only>
    <div class="hero">
      <h1>관리자 권한이 필요합니다</h1>
      <p>이 페이지에 접근하려면 관리자 계정으로 로그인해야 합니다.</p>
      <a href="{{ url_for('auth.login') }}" class="btn btn--primary">로그인</a>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/admin-table-view-page.js') }}"></script>
{% endblock %}
