{% extends "base.html" %}

{% block title %}íšŒì› ê´€ë¦¬ - ê´€ë¦¬ì - WeTube{% endblock %}

{% block content %}
  <div class="admin-page admin-users-page">
    <div class="admin-header">
      <div class="admin-header-left">
        <a href="{{ url_for('admin.index') }}" class="admin-back-link">â† ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</a>
        <h1 class="admin-title">íšŒì› ê´€ë¦¬</h1>
      </div>
      <div class="admin-header-actions">
        <a href="{{ url_for('auth.logout') }}" class="btn btn--outline">ë¡œê·¸ì•„ì›ƒ</a>
      </div>
    </div>

    <div class="admin-content">
      <!-- ê²€ìƒ‰ / í•„í„° -->
      <div class="admin-toolbar">
        <form method="get" action="{{ url_for('admin.users') }}" class="admin-search">
          <input type="search" name="q" id="user-search" class="admin-search-input" placeholder="ì•„ì´ë””, ì´ë©”ì¼, ë‹‰ë„¤ì„ ê²€ìƒ‰" value="{{ request.args.get('q', '') }}">
          <button type="submit" class="btn btn--primary" id="btn-search">ê²€ìƒ‰</button>
        </form>
        <div class="admin-filters">
          <select id="user-status-filter" class="admin-select">
            <option value="all">ì „ì²´ ìƒíƒœ</option>
            <option value="active">í™œì„±</option>
            <option value="inactive">ë¹„í™œì„±</option>
            <option value="suspended">ì •ì§€</option>
          </select>
        </div>
      </div>

      <!-- íšŒì› ëª©ë¡ í…Œì´ë¸” (DB ì‹¤ë°ì´í„°) -->
      <div class="admin-table-wrap">
        <table class="admin-table">
          <thead>
            <tr>
              <th class="col-num">#</th>
              <th class="col-username">ì•„ì´ë””</th>
              <th class="col-email">ì´ë©”ì¼</th>
              <th class="col-nickname">ë‹‰ë„¤ì„</th>
              <th class="col-date">ê°€ì…ì¼</th>
              <th class="col-status">ìƒíƒœ</th>
              <th class="col-actions">ê´€ë¦¬</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users.items %}
            <tr>
              <td class="col-num">{{ (users.page - 1) * users.per_page + loop.index }}</td>
              <td class="col-username">{{ user.username }}</td>
              <td class="col-email">{{ user.email }}</td>
              <td class="col-nickname">{{ user.nickname or '-' }}</td>
              <td class="col-date">{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else '-' }}</td>
              <td class="col-status">
                <span class="status-badge status-active">í™œì„±</span>
              </td>
              <td class="col-actions">
                <a href="{{ url_for('auth.profile') }}" class="btn-icon" title="ìˆ˜ì •">âœï¸</a>
                <button type="button" class="btn-icon btn-icon--danger" title="ì‚­ì œ">ğŸ—‘ï¸</button>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="7" class="admin-empty">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
      {% if users.pages > 1 %}
      <div class="admin-pagination">
        {% if users.has_prev %}
        <a href="{{ url_for('admin.users', page=users.prev_num, q=request.args.get('q', '')) }}" class="btn btn--outline btn--small">ì´ì „</a>
        {% else %}
        <span class="btn btn--outline btn--small" disabled>ì´ì „</span>
        {% endif %}
        <span class="pagination-info">{{ users.page }} / {{ users.pages }} í˜ì´ì§€</span>
        {% if users.has_next %}
        <a href="{{ url_for('admin.users', page=users.next_num, q=request.args.get('q', '')) }}" class="btn btn--outline btn--small">ë‹¤ìŒ</a>
        {% else %}
        <span class="btn btn--outline btn--small" disabled>ë‹¤ìŒ</span>
        {% endif %}
      </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/admin-users-page.js') }}"></script>
{% endblock %}
