{% extends "base.html" %}

{% block title %}검색: {{ query or '' }} - WeTube{% endblock %}

{% block content %}
  <div class="search-page" data-logged-in-only>
    <!-- 검색 필터 -->
    <div class="search-filters">
      <div class="filter-tabs">
        <button type="button" class="filter-tab active" data-filter="all">전체</button>
        <button type="button" class="filter-tab" data-filter="videos">동영상</button>
        <button type="button" class="filter-tab" data-filter="channels">채널</button>
        <button type="button" class="filter-tab" data-filter="playlists">재생목록</button>
      </div>
      <div class="search-sort">
        <button type="button" class="sort-btn" id="sort-btn">
          <span class="sort-icon">🔽</span>
          <span class="sort-text">정렬 기준</span>
        </button>
        <div class="sort-menu" id="sort-menu" style="display: none;">
          <button type="button" class="sort-option active" data-sort="relevance">관련성</button>
          <button type="button" class="sort-option" data-sort="date">업로드 날짜</button>
          <button type="button" class="sort-option" data-sort="views">조회수</button>
          <button type="button" class="sort-option" data-sort="rating">평점</button>
        </div>
      </div>
    </div>

    <!-- 검색 결과 -->
    <div class="search-results">
      {% if query %}
      <div class="search-results-header">
        <p class="search-results-count">
          <strong id="results-count">{{ results_count or 0 }}</strong>개의 결과
        </p>
        <p class="search-query">검색어: <strong>{{ query }}</strong></p>
      </div>

      <!-- 동영상 결과 -->
      <div class="search-results-list" id="results-list" data-filter="all">
        {% for i in range(10) %}
        <div class="search-result-item" data-type="video">
          <a href="{{ url_for('main.watch', video_id=i+1) }}" class="result-thumb">
            <div class="result-thumb-placeholder">📹</div>
            <span class="result-duration">10:{{ '%02d'|format(i+1) }}</span>
          </a>
          <div class="result-info">
            <h3 class="result-title">
              <a href="{{ url_for('main.watch', video_id=i+1) }}">{{ query }} 관련 동영상 {{ i + 1 }}</a>
            </h3>
            <div class="result-meta">
              <span class="result-views">조회수 {{ (i + 1) * 100 }}회</span>
              <span class="result-date">· {{ i + 1 }}일 전</span>
            </div>
            <div class="result-channel">
              <a href="{{ url_for('main.user_profile', username='user' ~ (i+1)) }}" class="channel-link">채널 {{ i + 1 }}</a>
            </div>
            <p class="result-description">
              "{{ query }}"에 대한 검색 결과입니다. 이것은 샘플 동영상 설명입니다. 프론트엔드 전용으로 구현되었습니다.
            </p>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- 채널 결과 (필터: channels일 때만 표시) -->
      <div class="search-results-list" id="results-channels" data-filter="channels" style="display: none;">
        {% for i in range(5) %}
        <div class="search-result-item search-result-item--channel" data-type="channel">
          <a href="{{ url_for('main.user_profile', username='channel' ~ (i+1)) }}" class="result-channel-avatar">
            <span>C{{ i + 1 }}</span>
          </a>
          <div class="result-info">
            <h3 class="result-title">
              <a href="{{ url_for('main.user_profile', username='channel' ~ (i+1)) }}">{{ query }} 채널 {{ i + 1 }}</a>
            </h3>
            <div class="result-meta">
              <span class="result-subs">구독자 {{ (i + 1) * 50 }}명</span>
              <span class="result-videos">· 동영상 {{ (i + 1) * 10 }}개</span>
            </div>
            <p class="result-description">
              "{{ query }}" 관련 채널입니다. 프론트엔드 전용 샘플 데이터입니다.
            </p>
            <button type="button" class="btn btn--primary btn--small" data-subscribe>구독</button>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <!-- 검색어 없을 때 -->
      <div class="search-empty">
        <div class="search-empty-icon">🔍</div>
        <h2 class="search-empty-title">검색어를 입력하세요</h2>
        <p class="search-empty-text">위의 검색창에 검색어를 입력하여 동영상을 찾아보세요.</p>
      </div>
      {% endif %}
    </div>
  </div>

  <div class="search-logged-out" data-logged-out-only>
    <div class="hero">
      <h1>검색하려면 로그인이 필요합니다</h1>
      <p>동영상을 검색하려면 로그인해주세요.</p>
      <a href="{{ url_for('auth.login') }}" class="btn btn--primary">로그인</a>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/search-page.js') }}"></script>
{% endblock %}
