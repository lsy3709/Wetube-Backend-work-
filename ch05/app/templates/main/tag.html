{% extends "base.html" %}

{% block title %}#{{ tag }} - WeTube{% endblock %}

{% block content %}
  <div class="tag-page">
    <!-- ì¸ê¸° íƒœê·¸ (DB ì—°ë™) -->
    {% if popular_tags %}
    <div class="popular-tags-section">
      <h2 class="popular-tags-title">ì¸ê¸° íƒœê·¸</h2>
      <div class="popular-tags">
        {% for t in popular_tags %}
        <a href="{{ url_for('main.tag', tag_name=t.name) }}" class="tag-pill {% if tag == t.name %}active{% endif %}">#{{ t.name }}</a>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- íƒœê·¸ë³„ ì˜ìƒ ë¦¬ìŠ¤íŠ¸ (DB ì—°ë™) -->
    <div class="tag-results">
      <div class="tag-results-header">
        <h1 class="tag-results-title">#{{ tag }}</h1>
        <p class="tag-results-count"><strong>{{ results_count }}</strong>ê°œì˜ ë™ì˜ìƒ</p>
      </div>

      <div class="tag-video-grid">
        {% for video in videos or [] %}
        <article class="video-card">
          <a href="{{ url_for('main.watch', video_id=video.id) }}" class="video-card-link">
            <div class="video-card-thumb">
              {% if video.thumbnail_path %}
              <img src="{{ url_for('main.media_thumbnail', filename=video.thumbnail_path) }}" alt="" class="video-card-thumb-img">
              {% else %}
              <span>ğŸ“¹</span>
              {% endif %}
            </div>
            <h3 class="video-card-title">{{ video.title }}</h3>
          </a>
          <a href="{{ url_for('main.user_profile', username=video.user.username if video.user else 'default') }}" class="video-card-channel">{{ video.user.username if video.user else 'default' }}</a>
          <p class="video-card-meta">ì¡°íšŒìˆ˜ {{ video.views }}íšŒ</p>
          <a href="{{ url_for('main.tag', tag_name=tag) }}" class="video-card-tag">#{{ tag }}</a>
        </article>
        {% else %}
        <p class="tag-empty">"#{{ tag }}" íƒœê·¸ê°€ ë¶™ì€ ë™ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
      </div>
    </div>
  </div>

{% endblock %}

{% block scripts %}
  {{ super() }}
{% endblock %}
