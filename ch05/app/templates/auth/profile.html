{% extends "base.html" %}

{% block title %}λ§μ΄νμ΄μ§€ - WeTube{% endblock %}

{% block content %}
  <div class="auth-page mypage-page">
    <div class="auth-card">
      <div class="mypage-header">
        <h1>λ§μ΄νμ΄μ§€</h1>
        <p class="mypage-desc">νμ› μ •λ³΄λ¥Ό ν™•μΈν•κ³  μμ •ν•  μ μμµλ‹λ‹¤.</p>
      </div>

      <p id="profile-msg" class="auth-msg" role="status" aria-live="polite"></p>
      <form id="profile-form" class="auth-form" method="post" action="{{ url_for('auth.profile') }}" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <!-- ν”„λ΅ν•„ μ‚¬μ§„ (λ§¨ μ„) -->
        <div class="form-group profile-image-group mypage-profile-top">
          <label>ν”„λ΅ν•„ μ‚¬μ§„</label>
          <div class="profile-image-wrapper">
            <div class="profile-image-preview">
              <img id="profile-image-preview" src="{{ current_user.get_profile_image_url() or '' }}" alt="ν”„λ΅ν•„ λ―Έλ¦¬λ³΄κΈ°" style="{% if not current_user.profile_image %}display: none;{% endif %}">
              <div id="profile-image-placeholder" class="profile-image-placeholder" style="{% if current_user.profile_image %}display: none;{% endif %}">
                <span class="profile-image-icon">π‘¤</span>
                <span class="profile-image-text">μ‚¬μ§„ μ—†μ</span>
              </div>
            </div>
            <div class="profile-image-actions">
              <label for="profile-image-input" class="btn btn--outline" style="cursor: pointer; margin-bottom: 8px;">
                μ‚¬μ§„ μ„ νƒ
              </label>
              <input type="file" id="profile-image-input" name="profile_image" accept="image/*" style="display: none;">
              <button type="button" id="profile-image-remove" class="btn btn--outline" style="display: none;">μ‚¬μ§„ μ κ±°</button>
            </div>
          </div>
        </div>

        <h2 class="mypage-section-title">νμ› μ •λ³΄ μμ •</h2>
        <div class="form-group">
          <label for="profile-nickname">λ‹‰λ„¤μ„</label>
          <input type="text" id="profile-nickname" name="nickname" placeholder="λ‹‰λ„¤μ„" autocomplete="nickname" value="{{ nickname or (current_user.nickname or '') }}">
        </div>
        <div class="form-group">
          <label for="profile-email">μ΄λ©”μΌ <span class="required">*</span></label>
          <input type="email" id="profile-email" name="email" placeholder="μ΄λ©”μΌ" autocomplete="email" value="{{ email or (current_user.email or '') }}" required>
        </div>
        <div class="form-group profile-security-section">
          <label class="section-label">λ³΄μ•</label>
          <div class="form-group">
            <label for="profile-current-password">ν„μ¬ λΉ„λ°€λ²νΈ</label>
            <input type="password" id="profile-current-password" name="current_password" placeholder="ν„μ¬ λΉ„λ°€λ²νΈ" autocomplete="current-password">
            <small class="form-hint">λΉ„λ°€λ²νΈλ¥Ό λ³€κ²½ν•  λ•λ§ μ…λ ¥ν•μ„Έμ”.</small>
          </div>
          <div class="form-group">
            <label for="profile-new-password">μƒ λΉ„λ°€λ²νΈ</label>
            <input type="password" id="profile-new-password" name="new_password" placeholder="μƒ λΉ„λ°€λ²νΈ" autocomplete="new-password">
          </div>
          <div class="form-group">
            <label for="profile-new-password-confirm">μƒ λΉ„λ°€λ²νΈ ν™•μΈ</label>
            <input type="password" id="profile-new-password-confirm" name="new_password_confirm" placeholder="μƒ λΉ„λ°€λ²νΈ ν™•μΈ" autocomplete="new-password">
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn--primary btn--block">μ €μ¥</button>
          <a href="{{ url_for('main.index') }}" class="btn btn--outline btn--block" style="margin-top: 12px; text-align: center; text-decoration: none;">μ·¨μ†</a>
        </div>
      </form>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/auth-profile-page.js') }}"></script>
{% endblock %}
